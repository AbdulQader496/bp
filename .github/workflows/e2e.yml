name: E2E Selenium Tests

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  e2e-tests:
    runs-on: windows-latest

    steps:
    # Checkout API repo (default)
    - name: Checkout API Repo
      uses: actions/checkout@v4

    # Checkout Selenium Test Repo
    - name: Checkout Selenium Tests Repo
      uses: actions/checkout@v4
      with:
        repository: AbdulQader496/bpTestSelenium
        path: selenium-tests

    # Install JDK
    - name: Set up JDK 21
      uses: actions/setup-java@v4
      with:
        java-version: "21"
        distribution: "temurin"

    # Install Chrome via action
    - name: Install Chrome
      uses: browser-actions/setup-chrome@v1
      with:
        chrome-version: latest

    # Install Chromedriver automatically matching Chrome version
    - name: Install ChromeDriver
      uses: nanasess/setup-chromedriver@v2

    # Verify Chrome + Driver versions
    - name: Verify browser setup
      shell: pwsh
      run: |
        chrome --version
        chromedriver --version

    # Run Selenium Tests
    - name: Run Maven Tests
      shell: pwsh
      working-directory: selenium-tests
      run: mvn -e -X clean test -DskipTests=false
